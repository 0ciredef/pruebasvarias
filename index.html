<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Decisi√≥n importante</title>

<style>
* {
  box-sizing: border-box;
  font-family: system-ui, sans-serif;
  touch-action: manipulation;
}

body {
  margin: 0;
  height: 100dvh;
  overflow: hidden;
  background: linear-gradient(135deg, #ffdde1, #ee9ca7);
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  width: 100%;
  max-width: 380px;
  height: 100%;
  padding: 10px;
  display: flex;
  flex-direction: column;
}

h1 {
  text-align: center;
  font-size: 1.3rem;
  margin: 6px 0;
}

#playfield {
  position: relative;
  flex: 1;
  border-radius: 16px;
  background: rgba(255,255,255,0.35);
  overflow: hidden;
}

/* BOTONES */
button {
  position: absolute;
  border: none;
  border-radius: 12px;
  padding: 14px 18px;
  font-size: 1rem;
  user-select: none;
}

#yes {
  background: #4caf50;
  color: white;
  left: 50%;
  bottom: 8px;
  transform: translateX(-50%);
  z-index: 50;
}

.no { background: #f44336; color: white; }
.fake { background: #555; color: #eee; }

#status {
  text-align: center;
  font-size: 0.8rem;
  margin-top: 4px;
}

/* FIESTA */
.party {
  background: radial-gradient(circle, #ff0, #f0f, #0ff);
  animation: partyBg 2s infinite alternate;
}

@keyframes partyBg {
  from { filter: hue-rotate(0deg); }
  to { filter: hue-rotate(360deg); }
}

.confetti {
  position: absolute;
  width: 8px;
  height: 8px;
  animation: fall 2.5s linear infinite;
}

@keyframes fall {
  from { transform: translateY(-10px) rotate(0deg); }
  to { transform: translateY(110%) rotate(360deg); }
}
</style>
</head>

<body>
<div class="container">
  <h1>¬øQuieres ver a Fede el 7 de febrero?</h1>

  <div id="playfield">
    <button id="yes">S√≠ üíñ</button>
  </div>

  <div id="status">Nivel 1</div>
</div>

<script>
const field = document.getElementById("playfield");
const yesBtn = document.getElementById("yes");
const status = document.getElementById("status");

let level = 1;
let attempts = 0;
let noBtn;
let vx = 1.3, vy = 1.3;
let x = 40, y = 40;
let bouncing = false;

/* ---------- UTIL ---------- */
function vibrar() {
  if (navigator.vibrate) navigator.vibrate(40);
}

function clearField() {
  [...field.querySelectorAll(".no, .fake, .confetti")].forEach(e => e.remove());
  bouncing = false;
}

function limits(btn) {
  return {
    maxX: field.clientWidth - btn.offsetWidth,
    maxY: field.clientHeight - btn.offsetHeight - 50
  };
}

function place(btn) {
  const { maxX, maxY } = limits(btn);
  btn.style.left = Math.random() * maxX + "px";
  btn.style.top = Math.random() * maxY + "px";
}

/* ---------- NIVELES 1‚Äì5 ---------- */
function spawnNo() {
  noBtn = document.createElement("button");
  noBtn.className = "no";
  noBtn.textContent = "No üôÉ";
  place(noBtn);
  noBtn.addEventListener("pointerdown", onNo);
  field.appendChild(noBtn);
}

function dvd() {
  if (bouncing) return;
  bouncing = true;

  function move() {
    if (!noBtn) return;
    const { maxX, maxY } = limits(noBtn);
    x += vx; y += vy;
    if (x <= 0 || x >= maxX) vx *= -1;
    if (y <= 0 || y >= maxY) vy *= -1;
    noBtn.style.left = x + "px";
    noBtn.style.top = y + "px";
    requestAnimationFrame(move);
  }
  move();
}

function onNo() {
  attempts++;
  vibrar();

  if (attempts === 2) level = 2;
  if (attempts === 4) level = 3;
  if (attempts === 6) level = 4;
  if (attempts === 8) level = 5;
  if (attempts === 10) level = 6;

  status.textContent = `Nivel ${level}`;
  yesBtn.style.transform =
    `translateX(-50%) scale(${1 + attempts * 0.05})`;

  if (level === 1) place(noBtn);
  if (level === 2) place(noBtn);
  if (level === 3) { vx *= 1.2; vy *= 1.2; dvd(); }
  if (level === 4) noBtn.style.transform = "scale(0.8)";
  if (level === 5) {
    const fake = noBtn.cloneNode(true);
    fake.className = "fake";
    place(fake);
    fake.addEventListener("pointerdown", () => fake.remove());
    field.appendChild(fake);
  }

  if (level >= 6) startMiniGames();
}

/* ---------- MINIJUEGOS 6+ ---------- */
function startMiniGames() {
  clearField();
  status.textContent = `Nivel ${level}`;

  if (level === 6) doors();
  if (level === 7) path();
  if (level === 8) timed();
  if (level === 9) memory();
  if (level === 10) dragKey();
  if (level === 11) blocker();
  if (level === 12) finalNo();
}

/* NIVEL 6 */
function doors() {
  let open = 0;
  for (let i = 0; i < 4; i++) {
    const d = document.createElement("button");
    d.className = "fake";
    d.textContent = "¬øNO?";
    place(d);
    d.addEventListener("pointerdown", () => {
      d.remove();
      vibrar();
      if (++open === 3) next();
    });
    field.appendChild(d);
  }
}

/* NIVEL 7 */
function path() {
  let idx = 0;
  for (let i = 0; i < 3; i++) {
    const s = document.createElement("button");
    s.className = "fake";
    s.textContent = i + 1;
    place(s);
    s.addEventListener("pointerdown", () => {
      if (i === idx) {
        s.remove(); idx++;
        vibrar();
        if (idx === 3) next();
      } else path();
    });
    field.appendChild(s);
  }
}

/* NIVEL 8 */
function timed() {
  setTimeout(() => {
    const n = document.createElement("button");
    n.className = "no";
    n.textContent = "No üôÉ";
    place(n);
    n.addEventListener("pointerdown", next);
    field.appendChild(n);
    setTimeout(() => n.remove(), 900);
  }, 500);
}

/* NIVEL 9 */
function memory() {
  const correct = Math.floor(Math.random() * 4);
  for (let i = 0; i < 4; i++) {
    const m = document.createElement("button");
    m.className = i === correct ? "no" : "fake";
    m.textContent = "NO";
    place(m);
    m.addEventListener("pointerdown", i === correct ? next : memory);
    field.appendChild(m);
  }
}

/* NIVEL 10 */
function dragKey() {
  const key = document.createElement("button");
  key.className = "fake";
  key.textContent = "üîë";
  place(key);

  const lock = document.createElement("button");
  lock.className = "no";
  lock.textContent = "üîí";
  place(lock);

  key.addEventListener("pointerdown", () => {
    key.remove();
    lock.textContent = "No üôÉ";
    lock.addEventListener("pointerdown", next);
  });

  field.appendChild(key);
  field.appendChild(lock);
}

/* NIVEL 11 */
function blocker() {
  const block = document.createElement("button");
  block.className = "fake";
  block.textContent = "üö´";
  place(block);

  const n = document.createElement("button");
  n.className = "no";
  n.textContent = "No üôÉ";
  place(n);

  let dir = 1;
  setInterval(() => {
    const { maxX } = limits(block);
    let bx = block.offsetLeft + dir * 20;
    if (bx <= 0 || bx >= maxX) dir *= -1;
    block.style.left = bx + "px";
  }, 80);

  n.addEventListener("pointerdown", next);
  field.appendChild(block);
  field.appendChild(n);
}

/* NIVEL 12 */
function finalNo() {
  const n = document.createElement("button");
  n.className = "no";
  n.textContent = "No üôÉ";
  place(n);
  n.addEventListener("pointerdown", () => alert("IMPOSIBLE üòà"));
  field.appendChild(n);
}

/* ---------- AVANZAR ---------- */
function next() {
  level++;
  clearField();
  status.textContent = `Nivel ${level}`;
  if (level <= 12) startMiniGames();
}

/* ---------- S√ç ---------- */
yesBtn.addEventListener("pointerdown", () => {
  field.classList.add("party");
  clearField();
  status.textContent = "üéâ SAB√çA QUE DIR√çAS QUE S√ç üéâ";

  for (let i = 0; i < 60; i++) {
    const c = document.createElement("div");
    c.className = "confetti";
    c.style.left = Math.random() * 100 + "%";
    c.style.background = `hsl(${Math.random()*360},100%,50%)`;
    c.style.animationDelay = Math.random() * 2 + "s";
    field.appendChild(c);
  }
});

/* ---------- START ---------- */
spawnNo();
</script>
</body>
</html>
